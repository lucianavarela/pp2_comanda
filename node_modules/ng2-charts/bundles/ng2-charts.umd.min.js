!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("chart.js"),require("@angular/core"),require("rxjs"),require("lodash")):"function"==typeof define&&define.amd?define("ng2-charts",["exports","chart.js","@angular/core","rxjs","lodash"],e):e(t["ng2-charts"]={},t.chart_js,t.ng.core,t.rxjs,t._)}(this,function(t,r,o,e,i){"use strict";var n=function(){return(n=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function a(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,a=r.call(t),i=[];try{for(;(void 0===e||0<e--)&&!(o=a.next()).done;)i.push(o.value)}catch(s){n={error:s}}finally{try{o&&!o.done&&(r=a["return"])&&r.call(a)}finally{if(n)throw n.error}}return i}var s=[[255,99,132],[54,162,235],[255,206,86],[231,233,237],[75,192,192],[151,187,205],[220,220,220],[247,70,74],[70,191,189],[253,180,92],[148,159,177],[77,83,96]];function l(t,e,r){if("pie"===t||"doughnut"===t)return u(f(r));if("polarArea"===t)return function o(t){return{backgroundColor:t.map(function(t){return h(t,.6)}),borderColor:t.map(function(t){return h(t,1)}),hoverBackgroundColor:t.map(function(t){return h(t,.8)}),hoverBorderColor:t.map(function(t){return h(t,1)})}}(f(r));if("line"===t||"radar"===t)return function n(t){return{backgroundColor:h(t,.4),borderColor:h(t,1),pointBackgroundColor:h(t,1),pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:h(t,.8)}}(p(e));if("bar"===t||"horizontalBar"===t)return function a(t){return{backgroundColor:h(t,.6),borderColor:h(t,1),hoverBackgroundColor:h(t,.8),hoverBorderColor:h(t,1)}}(p(e));if("bubble"===t)return u(f(r));if("scatter"===t)return u(f(r));throw new Error("getColors - Unsupported chart type "+t)}function h(t,e){return"rgba("+t.concat(e).join(",")+")"}function d(t,e){return Math.floor(Math.random()*(e-t+1))+t}function u(t){return{backgroundColor:t.map(function(t){return h(t,.6)}),borderColor:t.map(function(){return"#fff"}),pointBackgroundColor:t.map(function(t){return h(t,1)}),pointBorderColor:t.map(function(){return"#fff"}),pointHoverBackgroundColor:t.map(function(t){return h(t,1)}),pointHoverBorderColor:t.map(function(t){return h(t,1)})}}function c(){return[d(0,255),d(0,255),d(0,255)]}function p(t){return s[t]||c()}function f(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=s[r]||c();return e}var g=function(){function t(){this.pColorschemesOptions={},this.colorschemesOptions=new e.BehaviorSubject({})}return t.prototype.setColorschemesOptions=function(t){this.pColorschemesOptions=t,this.colorschemesOptions.next(t)},t.prototype.getColorschemesOptions=function(){return this.pColorschemesOptions},t.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=o.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),y={Default:0,Update:1,Refresh:2};y[y.Default]="Default",y[y.Update]="Update",y[y.Refresh]="Refresh";var b=function(){function t(t,e){this.element=t,this.themeService=e,this.options={},this.chartClick=new o.EventEmitter,this.chartHover=new o.EventEmitter,this.old={dataExists:!1,dataLength:0,datasetsExists:!1,datasetsLength:0,datasetsDataObjects:[],datasetsDataLengths:[],colorsExists:!1,colors:[],labelsExist:!1,labels:[],legendExists:!1,legend:{}},this.subs=[]}return t.registerPlugin=function(t){r.Chart.plugins.register(t)},t.unregisterPlugin=function(t){r.Chart.plugins.unregister(t)},t.prototype.ngOnInit=function(){var e=this;this.ctx=this.element.nativeElement.getContext("2d"),this.refresh(),this.subs.push(this.themeService.colorschemesOptions.subscribe(function(t){return e.themeChanged(t)}))},t.prototype.themeChanged=function(t){this.refresh()},t.prototype.ngDoCheck=function(){var r=this;if(this.chart){var e=y.Default,t=function(t){e=e<t?t:e};switch(!!this.data!==this.old.dataExists&&(this.propagateDataToDatasets(this.data),this.old.dataExists=!!this.data,t(y.Update)),this.data&&this.data.length!==this.old.dataLength&&(this.old.dataLength=this.data&&this.data.length||0,t(y.Update)),!!this.datasets!==this.old.datasetsExists&&(this.old.datasetsExists=!!this.datasets,t(y.Update)),this.datasets&&this.datasets.length!==this.old.datasetsLength&&(this.old.datasetsLength=this.datasets&&this.datasets.length||0,t(y.Update)),this.datasets&&this.datasets.filter(function(t,e){return t.data!==r.old.datasetsDataObjects[e]}).length&&(this.old.datasetsDataObjects=this.datasets.map(function(t){return t.data}),t(y.Update)),this.datasets&&this.datasets.filter(function(t,e){return t.data.length!==r.old.datasetsDataLengths[e]}).length&&(this.old.datasetsDataLengths=this.datasets.map(function(t){return t.data.length}),t(y.Update)),!!this.colors!==this.old.colorsExists&&(this.old.colorsExists=!!this.colors,this.updateColors(),t(y.Update)),this.colors&&this.colors.filter(function(t,e){return!r.colorsEqual(t,r.old.colors[e])}).length&&(this.old.colors=this.colors.map(function(t){return r.copyColor(t)}),this.updateColors(),t(y.Update)),!!this.labels!==this.old.labelsExist&&(this.old.labelsExist=!!this.labels,t(y.Update)),this.labels&&this.labels.filter(function(t,e){return!r.labelsEqual(t,r.old.labels[e])}).length&&(this.old.labels=this.labels.map(function(t){return r.copyLabel(t)}),t(y.Update)),!!this.options.legend!==this.old.legendExists&&(this.old.legendExists=!!this.options.legend,t(y.Refresh)),this.options.legend&&this.options.legend.position!==this.old.legend.position&&(this.old.legend.position=this.options.legend.position,t(y.Refresh)),e){case y.Default:break;case y.Update:this.update();break;case y.Refresh:this.refresh()}}},t.prototype.copyLabel=function(t){return Array.isArray(t)?function r(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t}(t):t},t.prototype.labelsEqual=function(t,r){return Array.isArray(t)===Array.isArray(r)&&(Array.isArray(t)||t===r)&&(!Array.isArray(t)||t.length===r.length)&&(!Array.isArray(t)||0===t.filter(function(t,e){return t!==r[e]}).length)},t.prototype.copyColor=function(t){return{backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderColor:t.borderColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,pointBorderColor:t.pointBorderColor,pointBackgroundColor:t.pointBackgroundColor,pointBorderWidth:t.pointBorderWidth,pointRadius:t.pointRadius,pointHoverRadius:t.pointHoverRadius,pointHitRadius:t.pointHitRadius,pointHoverBackgroundColor:t.pointHoverBackgroundColor,pointHoverBorderColor:t.pointHoverBorderColor,pointHoverBorderWidth:t.pointHoverBorderWidth,pointStyle:t.pointStyle,hoverBackgroundColor:t.hoverBackgroundColor,hoverBorderColor:t.hoverBorderColor,hoverBorderWidth:t.hoverBorderWidth}},t.prototype.colorsEqual=function(t,e){return!t==!e&&(!t||t.backgroundColor===e.backgroundColor&&t.borderWidth===e.borderWidth&&t.borderColor===e.borderColor&&t.borderCapStyle===e.borderCapStyle&&t.borderDash===e.borderDash&&t.borderDashOffset===e.borderDashOffset&&t.borderJoinStyle===e.borderJoinStyle&&t.pointBorderColor===e.pointBorderColor&&t.pointBackgroundColor===e.pointBackgroundColor&&t.pointBorderWidth===e.pointBorderWidth&&t.pointRadius===e.pointRadius&&t.pointHoverRadius===e.pointHoverRadius&&t.pointHitRadius===e.pointHitRadius&&t.pointHoverBackgroundColor===e.pointHoverBackgroundColor&&t.pointHoverBorderColor===e.pointHoverBorderColor&&t.pointHoverBorderWidth===e.pointHoverBorderWidth&&t.pointStyle===e.pointStyle&&t.hoverBackgroundColor===e.hoverBackgroundColor&&t.hoverBorderColor===e.hoverBorderColor&&t.hoverBorderWidth===e.hoverBorderWidth)},t.prototype.updateColors=function(){var r=this;this.datasets.forEach(function(t,e){r.colors&&r.colors[e]?Object.assign(t,r.colors[e]):Object.assign(t,l(r.chartType,e,t.data.length),n({},t))})},t.prototype.ngOnChanges=function(t){var e=y.Default,r=function(t){e=e<t?t:e};switch(t.hasOwnProperty("data")&&t.data.currentValue&&(this.propagateDataToDatasets(t.data.currentValue),r(y.Update)),t.hasOwnProperty("datasets")&&t.datasets.currentValue&&(this.propagateDatasetsToData(t.datasets.currentValue),r(y.Update)),t.hasOwnProperty("labels")&&(this.chart&&(this.chart.data.labels=t.labels.currentValue),r(y.Update)),t.hasOwnProperty("legend")&&(this.chart&&(this.chart.config.options.legend.display=t.legend.currentValue,this.chart.generateLegend()),r(y.Update)),t.hasOwnProperty("options")&&r(y.Refresh),e){case y.Update:this.update();break;case y.Refresh:case y.Default:this.refresh()}},t.prototype.ngOnDestroy=function(){this.chart&&(this.chart.destroy(),this.chart=void 0),this.subs.forEach(function(t){return t.unsubscribe()})},t.prototype.update=function(t,e){if(this.chart)return this.chart.update(t,e)},t.prototype.hideDataset=function(t,e){this.chart.getDatasetMeta(t).hidden=e,this.chart.update()},t.prototype.isDatasetHidden=function(t){return this.chart.getDatasetMeta(t).hidden},t.prototype.toBase64Image=function(){return this.chart.toBase64Image()},t.prototype.getChartConfiguration=function(){var r=this,t=this.getDatasets(),e=Object.assign({},this.options);!1===this.legend&&(e.legend={display:!1}),e.hover=e.hover||{},e.hover.onHover||(e.hover.onHover=function(t,e){e&&!e.length||r.chartHover.emit({event:t,active:e})}),e.onClick||(e.onClick=function(t,e){r.chartClick.emit({event:t,active:e})});var o=this.smartMerge(e,this.themeService.getColorschemesOptions());return{type:this.chartType,data:{labels:this.labels||[],datasets:t},plugins:this.plugins,options:o}},t.prototype.getChartBuilder=function(t){var e=this.getChartConfiguration();return new r.Chart(t,e)},t.prototype.smartMerge=function(r,o,n){var a=this;if(void 0===n&&(n=0),0===n&&(r=i.cloneDeep(r)),Object.keys(o).forEach(function(e){if(Array.isArray(o[e])){var t=r[e];t&&t.forEach(function(t){a.smartMerge(t,o[e][0],n+1)})}else"object"==typeof o[e]?(e in r||(r[e]={}),a.smartMerge(r[e],o[e],n+1)):r[e]=o[e]}),0===n)return r},t.prototype.isMultiLineLabel=function(t){return Array.isArray(t)},t.prototype.joinLabel=function(t){return t?this.isMultiLineLabel(t)?t.join(" "):t:null},t.prototype.propagateDatasetsToData=function(t){this.data=this.datasets.map(function(t){return t.data}),this.chart&&(this.chart.data.datasets=t),this.updateColors()},t.prototype.propagateDataToDatasets=function(r){var o=this;this.isMultiDataSet(r)?this.datasets&&r.length===this.datasets.length?this.datasets.forEach(function(t,e){t.data=r[e]}):(this.datasets=r.map(function(t,e){return{data:t,label:o.joinLabel(o.labels[e])||"Label "+e}}),this.chart&&(this.chart.data.datasets=this.datasets)):this.datasets?(this.datasets[0].data=r,this.datasets.splice(1)):(this.datasets=[{data:r}],this.chart&&(this.chart.data.datasets=this.datasets)),this.updateColors()},t.prototype.isMultiDataSet=function(t){return Array.isArray(t[0])},t.prototype.getDatasets=function(){if(!this.datasets&&!this.data)throw new Error("ng-charts configuration error, data or datasets field are required to render chart "+this.chartType);return this.datasets?(this.propagateDatasetsToData(this.datasets),this.datasets):this.data?(this.propagateDataToDatasets(this.data),this.datasets):void 0},t.prototype.refresh=function(){this.chart&&(this.chart.destroy(),this.chart=void 0),this.ctx&&(this.chart=this.getChartBuilder(this.ctx))},t.decorators=[{type:o.Directive,args:[{selector:"canvas[baseChart]",exportAs:"base-chart"}]}],t.ctorParameters=function(){return[{type:o.ElementRef},{type:g}]},t.propDecorators={data:[{type:o.Input}],datasets:[{type:o.Input}],labels:[{type:o.Input}],options:[{type:o.Input}],chartType:[{type:o.Input}],colors:[{type:o.Input}],legend:[{type:o.Input}],plugins:[{type:o.Input}],chartClick:[{type:o.Output}],chartHover:[{type:o.Output}]},t}(),C=function(){function t(){}return t.decorators=[{type:o.NgModule,args:[{declarations:[b],imports:[],exports:[b]}]}],t}(),H=Chart.helpers,E=Chart.defaults,A=H.valueOrDefault;function T(t,e){return t.usePointStyle&&t.boxWidth>e?e:t.boxWidth}function v(){var t=this,e=t.options,n=e.labels,r=e.display,a=t.ctx,o=H.options._parseFont(n),i=o.size,s=t.legendHitBoxes=[],l=t.minSize,h=t.isHorizontal();l.height=h?(l.width=t.maxWidth,r?10:0):(l.width=r?10:0,t.maxHeight);var d=function(t){return t.map(function(t){return a.measureText(t).width}).reduce(function(t,e){return t<e?e:t},0)};if(r)if(a.font=o.string,h){var u=t.lineWidths=[0],c=t.lineHeights=[],p=0,f=0;a.textAlign="left",a.textBaseline="top",H.each(t.legendItems,function(t,e){var r,o;o=H.isArray(t.text)?(r=d(t.text),i*t.text.length+n.padding):(r=a.measureText(t.text).width,i+n.padding),r+=T(n,i)+i/2,u[u.length-1]+r+2*n.padding>l.width&&(c.push(p),p=0,u[u.length-(0<e?0:1)]=0,f++),t.lineOrColumnIndex=f,p<o&&(p=o),s[e]={left:0,top:0,width:r,height:o},u[u.length-1]+=r+n.padding}),c.push(p),l.height+=c.reduce(function(t,e){return t+e},0)}else{var g=n.padding,y=t.columnWidths=[],b=t.columnHeights=[],C=n.padding,v=0,x=0,m=0;H.each(t.legendItems,function(t,e){var r,o;o=H.isArray(t.text)?(r=d(t.text),i*t.text.length):(r=a.measureText(t.text).width,i),r+=T(n,i)+i/2,x+i+2*g>l.height&&(C+=v+n.padding,y.push(v),b.push(x),x=v=0,m++),t.lineOrColumnIndex=m,v=Math.max(v,r),x+=o+g,s[e]={left:0,top:0,width:r,height:o}}),C+=v,y.push(v),b.push(x),l.width+=C}t.width=l.width,t.height=l.height}function x(){var h=this,d=h.options,u=d.labels,t=E.global,c=t.defaultColor,p=t.elements.line,f=h.height,g=h.columnHeights,y=h.columnWidths,b=h.width,C=h.lineWidths,v=h.lineHeights;if(d.display){var x,m=h.ctx,e=A(u.fontColor,t.defaultFontColor),r=H.options._parseFont(u),B=r.size;m.textAlign="left",m.textBaseline="middle",m.lineWidth=.5,m.strokeStyle=e,m.fillStyle=e,m.font=r.string;var D=T(u,B),k=h.legendHitBoxes,S=function(t,e,r,o){var n,a,i,s,l,h,d,u=B/2,c=D+u+t,p=e+u;H.isArray(r.text)?H.each(r.text,function(t,e){var r=e*B;m.fillText(t,c,p+r)}):m.fillText(r.text,c,p),r.hidden&&(H.isArray(r.text)?(s=c,l=p,h=o,d=(r.text.length-1)*(B-1),m.beginPath(),m.lineWidth=2,m.moveTo(s,l),m.lineTo(s+h,l+d),m.moveTo(s,l+d),m.lineTo(s+h,l)):(n=c,a=p,i=o,m.beginPath(),m.lineWidth=2,m.moveTo(n,a),m.lineTo(n+i,a)),m.stroke())},O=function(t,e){switch(d.align){case"start":return u.padding;case"end":return t-e;default:return(t-e+u.padding)/2}},w=h.isHorizontal();x=w?{x:h.left+O(b,C[0]),y:h.top+u.padding,line:0}:{x:h.left+u.padding,y:h.top+O(f,g[0]),line:0},H.each(h.legendItems,function(t,e){var r,o,n;t.lineOrColumnIndex>x.line&&(w?(x.y+=v[x.line],x.line=t.lineOrColumnIndex,x.x=h.left+O(b,C[x.line])):(x.x+=y[x.line]+u.padding,x.line=t.lineOrColumnIndex,x.y=h.top+O(f,g[x.line]))),o=H.isArray(t.text)?(r=t.text.map(function(t){return m.measureText(t).width}).reduce(function(t,e){return t<e?e:t},0),n=B/2*(t.text.length-1),B*t.text.length):(r=m.measureText(t.text).width,n=0,B);var a=D+B/2+r,i=x.x,s=x.y,l=w?Math.trunc((v[x.line]-k[e].height)/2):0;!function(t,e,r){if(!(isNaN(D)||D<=0)){m.save();var o=A(r.lineWidth,p.borderWidth);if(m.fillStyle=A(r.fillStyle,c),m.lineCap=A(r.lineCap,p.borderCapStyle),m.lineDashOffset=A(r.lineDashOffset,p.borderDashOffset),m.lineJoin=A(r.lineJoin,p.borderJoinStyle),m.lineWidth=o,m.strokeStyle=A(r.strokeStyle,c),m.setLineDash&&m.setLineDash(A(r.lineDash,p.borderDash)),d.labels&&d.labels.usePointStyle){var n=D*Math.SQRT2/2,a=t+D/2,i=e+B/2;H.canvas.drawPoint(m,r.pointStyle,n,a,i)}else 0!==o&&m.strokeRect(t,e,D,B),m.fillRect(t,e,D,B);m.restore()}}(i,s+n+l,t),k[e].left=i,k[e].top=s,S(i,s+l,t,r),w?x.x+=a+u.padding:x.y+=o+u.padding})}}var m=Chart.helpers;function B(t,e){return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-t.xPadding:t.x+t.xPadding}function D(r,o,n){var a,i=o.bodyFontSize,e=o.bodySpacing,t=o._bodyAlign,s=o.body,l=o.displayColors,h=o.labelColors,d=0,u=l?B(o,"left"):0;n.textAlign=t,n.textBaseline="top",n.font=m.fontString(i,o._bodyFontStyle,o._bodyFontFamily),r.x=B(o,t);var c=function(t){n.fillText(t,r.x+d,r.y),r.y+=i+e};n.fillStyle=o.bodyFontColor,m.each(o.beforeBody,c),d=l&&"right"!==t?"center"===t?i/2+1:i+2:0,m.each(s,function(t,e){a=o.labelTextColors[e],n.fillStyle=a,m.each(t.before,c),l&&(n.fillStyle=o.legendColorBackground,n.fillRect(u,r.y,i,i),n.lineWidth=1,n.strokeStyle=h[e].borderColor,n.strokeRect(u,r.y,i,i),n.fillStyle=h[e].backgroundColor,n.fillRect(u+1,r.y+1,i-2,i-2),n.fillStyle=a),m.each(t.lines,c),m.each(t.after,c)}),d=0,m.each(o.afterBody,c),r.y-=e}t.ChartsModule=C,t.BaseChartDirective=b,t.defaultColors=s,t.ThemeService=g,t.monkeyPatchChartJsLegend=function k(){var t=Chart.plugins.getAll().filter(function(t){return"legend"===t.id})[0];t._element.prototype.fit=v,t._element.prototype.draw=x},t.monkeyPatchChartJsTooltip=function S(){Chart.Tooltip.prototype.drawBody=D},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ng2-charts.umd.min.js.map